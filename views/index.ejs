<%- include("partials/header")-%>


<head>
  <meta charset="utf-8">
  <title>BechDaal</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Bech Daal</title>
  <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/homepage.css">

</head>

<body>
  <div class="row no-gutters">
    <div class="col-md-10" style="padding-right:0">
      <br>

      <h3 style="color: DodgerBlue; text-align:center">Browse Categories</h3>

      <div class="flex-container" id="cont">

      </div>
      <ul class="pagination">
        <li class="page-item">
          <a class="page-link" href="#" id="previous" aria-label="Previous">
            <span aria-hidden="true">&laquo;</span>
            <span class="sr-only">Previous</span>
          </a>
        </li>
        <li class="page-item"><a id="first" class="page-link" href="#">1</a></li>
        <li id="next" class="page-item">
          <a class="page-link" id="Next" href="#">
            <span aria-hidden="true">&raquo;</span>
            <span class="sr-only">Next</span>
          </a>
        </li>
      </ul>
      <hr style="height:1px;background-color:black;margin: 10px 15%;">
      <div class="flex-container">
        <%ads.forEach(ad=>{%>
        <div class="two">
          <%if (typeof(ad.cover_photo)==='undefined'){%>
          <img class="images" src='images/1.jpg'><i class="fa fa-heart icondisplay" aria-hidden="true"></i>
          <%} else {%>
          <img class="images" src='<%= ad.cover_photo %>'><i class="fa fa-heart icondisplay" aria-hidden="true"></i>
          <%}%>
          <p class="para">â‚¹ <%=ad.price%></p>
          <p class="para"><%=ad.title%></p>
          <k><%=ad.date_posted%></k>
        </div>
        <%})%>

      </div>

    </div>
    <div class="col-md-2" style="background-color:blue">
      <h2 style="text-align:center;">Ads</h2>
    </div>
  </div>


  <script>
    let arr = []
  </script>
  <% categries.forEach(val => {%>
  <script>
    var obj1 = {}
    obj1.name = "<%=val.name%>"
    obj1.img = "<%=val.image%>"
    obj1.id = "<%=val._id%>"
    arr.push(obj1)
  </script>
  <%}) %>
  <script>
    console.log(arr)

    let data;
    let page = 0;
    const main = document.querySelector(".mainContent");
    $(document).ready(function () {
      for (var i = 0; i < 3; i++) {
        $("#cont").append("<div id='" + arr[i].id + "' class='one'>\
            <img class='Img' src = '"+ arr[i].img + "'> <br>\
              "+ arr[i].name + "</div>")
      }
    })
    const first = document.querySelector("#first");
    const previous = document.querySelector("#previous");
    const next = document.querySelector("#next");
    next.addEventListener('click', () => {
      first.textContent = ""
      page += 1;
      if ((arr.length / 3) + 1 > (page + 1)) {
        var ctr = page + 1;
        first.textContent = ctr
        let s = arr.slice(3 * page, 3 * page + 3)
        $("#cont").empty();
        for (let i = 0; i < 3; i++) {
          $("#cont").append(
            "<div id='" + s[i].id + "' class='one'>\
            <img class='Img' src = '"+ s[i].img + "'> <br>\
              "+ s[i].name + "</div>")
        }
      } else {
        page -= 1;
        first.textContent = "Last"
      }
    })
    previous.addEventListener('click', () => {
      first.textContent = ""
      page -= 1;
      console.log(page)
      if (page >= 0) {
        var ctr = page + 1;
        first.textContent = ctr
        let s = arr.slice(3 * ctr - 3, 3 * ctr)

        $("#cont").empty();
        for (let i = 0; i < 3; i++) {
          $("#cont").append(
            "<div id='" + s[i].id + "' class='one'>\
            <img class='Img' src = '"+ s[i].img + "'> <br>\
              "+ s[i].name + "</div>")
        }
      } else {
        page += 1;
        first.textContent = "First"
      }
    })
  </script>
</body>

<%-include("partials/footer")-%>