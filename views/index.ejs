<%- include("partials/header")-%>


<head>
  <meta charset="utf-8">
  <title>BechDaal</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Bech Daal</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/homepage.css">

</head>

<body>
  <div class="row no-gutters">
    <div class="col-md-10" style="padding-right:0">
      <br>

      <h3 style="color: DodgerBlue; text-align:center">Browse Categories</h3>

      <div class="flex-container">
        <%categries.forEach(category=>{%>
        <div id='<%=category._id%>' class="one">
          <img class='Img' src='<%=category.image%>'><br>
          <%=category.name%></div>
        <%})%>
        <div class="one">5</div>
        <div class="one">6</div>
        <div class="one">7</div>
        <div class="one">8</div>
      </div>
      <hr style="height:1px;background-color:black;margin: 10px 15%;">
      <div class="flex-container">
        <div class="paginatedContent">
          <!-- paginated ads go here -->
        </div>
        <!-- <%ads.forEach(ad=>{%>
        <div class="two">
          <%if (typeof(ad.cover_photo)==='undefined'){%>
            <img class="images" src='images/1.jpg'><i class="fa fa-heart icondisplay" aria-hidden="true"></i>
          <%} else {%>
            <img class="images" src='<%= ad.cover_photo %>'><i class="fa fa-heart icondisplay" aria-hidden="true"></i>
          <%}%>
          <p class="para">₹ <%=ad.price%></p>
          <p class="para"><%=ad.title%></p>
          <k><%=ad.date_posted%></k>
        </div>
        <%})%> -->

      </div>
      <ul class="pagination">
        <li class="page-item">
          <a class="page-link" href="#" id="previous" aria-label="Previous">
            <span aria-hidden="true">&laquo;</span>
            <span class="sr-only">Previous</span>
          </a>
        </li>
        <li class="page-item"><a id="first" class="page-link" href="#">1</a></li>
        <li id="next" class="page-item">
          <a class="page-link" id="Next" href="#">
            <span aria-hidden="true">&raquo;</span>
            <span class="sr-only">Next</span>
          </a>
        </li>
      </ul>
    </div>
    <div class="col-md-2" style="background-color:blue">
      <h2 style="text-align:center;">Ads</h2>
    </div>
  </div>
  <script>
    let data;
    let page = 0;
    $.ajax({
      type: 'GET',
      url: '/',
      success: function (res) {
        data = [...res];
        console.log(data)
        let s = data.slice(0, 2);
        for (let i = 0; i < 2; i++) {
          $(".paginationContent").append(

            "<div class='" + two + "'>\
          '<%if (typeof(ad.cover_photo)==='" + undefined + "'){%>'\
            <img class="images" src='images/1.jpg'><i class='fa fa-heart icondisplay" aria - hidden="true" ></i >
          '<%} else {%>'
          < img class= "images" src = '<%= ad.cover_photo %>' > <i class="fa fa-heart icondisplay" aria-hidden="true"></i>
          <%}%>
            <p class="para">₹ <%=ad.price%></p>
            <p class="para"><%=ad.title%></p>
            <k><%=ad.date_posted%></k>
        </div >
          ")
      }
    },
      error: function (err) {
        console.log(err);
      }
    })
    const main = document.querySelector("#main")
    const first = document.querySelector("#first");
    const previous = document.querySelector("#previous");
    const next = document.querySelector("#next");


    next.addEventListener('click', () => {
      first.textContent = ""
      page += 1;
      if ((data.length / 2) + 1 >= (page + 1)) {
        var ctr = page + 1;
        first.textContent = ctr
        let s = data.slice(2 * page, 2 * page + 2)
        $(".mainContent").empty();
        for (let i = 0; i < 2; i++) {
          $(".mainContent").append(
            "<div id='" + s[i]._id + "' onclick='editad(this)' class='col-md-4 col-sm-12 paddings'>\<div class='card bg-danger text-white car mx-auto'> <div class='card-body'> <img class='Img mx-auto' style='text-align: center;' src='/" + s[i].cover_photo.filename + " %>' />\
                    <br />\
                    <label for='title' class='text'>Title</label>\
                    <label for='' class='label-text'>"+ s[i].title + "\
                    </label>\
                    <br />\
                    <label for='title'>Date posted</label>\
                    <label for='' class='label-text'>"+ s[i].date_posted + "</label>\
                  </div>\
                </div>\
              </div>")
        }
      } else {
        page -= 1;
        first.textContent = "Last"
      }
    })
    previous.addEventListener('click', () => {
      first.textContent = ""
      page -= 1;
      if ((data.length / 2) + 1 >= (page + 1)) {
        var ctr = page + 1;
        first.textContent = ctr
        let s = data.slice(2 * page, 2 * page + 2)
        $(".mainContent").empty();
        for (let i = 0; i < 2; i++) {
          $(".mainContent").append(
            "<div id='" + s[i]._id + "' onclick='editad(this)' class='col-md-4 col-sm-12 paddings'>\<div class='card bg-danger text-white car mx-auto'> <div class='card-body'> <img class='Img mx-auto' style='text-align: center;' src='/" + s[i].cover_photo.filename + " %>' />\
                    <br />\
                    <label for='title' class='text'>Title</label>\
                    <label for='' class='label-text'>"+ s[i].title + "\
                    </label>\
                    <br />\
                    <label for='title'>Date posted</label>\
                    <label for='' class='label-text'>"+ s[i].date_posted + "</label>\
                  </div>\
                </div>\
              </div>")
        }
      } else {
        page += 1;
        first.textContent = "First"
      }
    })

  </script>
</body>

<%-include("partials/footer")-%>