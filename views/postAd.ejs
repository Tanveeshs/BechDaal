<%-include('partials/header')-%>

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.1/css/all.css" integrity="sha384-xxzQGERXS00kBmZW/6qxqJPyxW3UR0BPsL4c8ILaIWXva5kFi7TxkIIaMiKtqV1Q" crossorigin="anonymous">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

<style media="screen">
  #custom-button {
    padding: 10px;
    color: white;
    background-color: #009578;
    border: 1px solid #000;
    border-radius: 5px;
    cursor: pointer;
  }

  input,
  select,
  textarea {
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
  }

  button {
    width: 100%;
    background-color: #4CAF50;
    color: white;
    padding: 14px 20px;
    margin: 8px 0;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }

  button:hover {
    background-color: #45a049;
  }

  #custom-button:hover {
    background-color: #00b28f;
  }

  #custom-text {
    margin-left: 10px;
    font-family: sans-serif;
    color: #aaa;
  }

  table,
  td {
    border: 5px solid grey;
    padding: 5px;
  }

  table {
    border-spacing: 5px;
  }

  td {
    text-align: center;
    padding: 10px 20px 20px;
  }

  .fileButton {
    cursor: pointer;
    font-size: 20px;
    margin-bottom: 10px;
  }

  .Img {
    width: 100px;
    height: 100px;
    border-radius: 25px;
  }

  .vis1,
  .vis2,
  .vis3,
  .vis4,
  .vis5,
  .vis6,
  .vis7,
  .vis8,
  #cross0,
  #cross1,
  #cross2,
  #cross3,
  #cross4,
  #cross5,
  #cross6,
  #cross7,
  #cross8 {
    display: none;
  }

  .fileLabel {
    display: none;
  }

  .fas0 {
    font-weight: 900;
    font-family: "Font Awesome 5 Free";
    font-style: normal;
    font-variant: normal;
    text-rendering: auto;
    line-height: 1;
    cursor: pointer;
  }
</style>

<form method="post" action="/sell/" enctype="multipart/form-data">

  <center>
    <input style="width:20%;text-align:center" class="w3-input w3-border" style="text-align:center" placeholder="Your descriptive Title..." name="title" />
  </center>
  <br>
  <br>
  <div class="row" style="padding: 50px 10px 20px 10px;">
    <div class="col-md-8">
      <div class="w3-row-padding">
        <div class="w3-half">
          <label>Category</label>
          <select class="w3-input w3-border" style="text-align:center" name="category" id="category">
          </select>
        </div>
        <div class="w3-half">
          <label>Subcategory</label>
          <select class="w3-input w3-border" style="text-align:center" name="subcategory" id="subcategory">
            <option value="volvo">Volvo</option>
            <option value="saab">Saab</option>
            <option value="mercedes">Mercedes</option>
            <option value="audi">Audi</option>
          </select>
        </div>
      </div>
      <br>
      <br />
      <div class="w3-row-padding">
        <div class="w3-half">
          <label for="brand">Brand</label>
          <input type="text" class="w3-input w3-border" style="text-align:center" type="text" name="brand" />
        </div>
        <div class="w3-half">
          <label for="model">Model</label>
          <input type="text" class="w3-input w3-border" style="text-align:center" name="model" />
        </div>
      </div>
      <br />
      <br>
      <div class="w3-row-padding">
        <div class="w3-half">
          <label for="price">Price</label>
          <input class="w3-input w3-border" style="text-align:center" type="text" name="price" />
        </div>
      </div>
      <br />
      <br>
      <div class="w3-row-padding">
        <div class="w3-half">
          <label for="description">Description</label>
          <textarea class="w3-input w3-border" style="text-align:center" name="description"></textarea>
        </div>
      </div>
      <br>
      <br>
      <br>
    </div>
    <div class="col-md-4">
      <center>
        <img id="cover-pic" src="" alt="" style="width:300px;height:300px;">
      </center>
    </div>
  </div>

  <hr />
  <br>
  <label style="padding-left:3%;padding-right:20%;" for="images">Upload images of your device (maximum of 9) </label>
  <br>
  <div style="padding-left:3%">
    <table>
      <tr>
        <td class="vis0">
          <div style="position:relative">
            <input type="file" name="images" onchange="readURL(this);" id="fileInput" hidden='hidden' class="blah0" />
            <div style="position:absolute">
              <i id="cross0" class="fas0 fa-times "></i>
            </div>
            <i id="plus0" class="far fa-plus-square fileButton"></i><br>
            <img id="blah0" class="Img" src="images/Imagehere.jpg" alt="" /><br>
            <span class="fileLabel"></span>
          </div>
        </td>
        <td class="vis1">
          <div style="position:relative">
            <input type="file" name="images" onchange="readURL(this);" id="fileInput" hidden='hidden' class="blah1" />
            <div style="position:absolute">
              <i id="cross1" class="fas0 fa-times "></i>
            </div>
            <i id="plus1" class="far fa-plus-square fileButton"></i><br>
            <img id="blah1" class="Img" src="images/Imagehere.jpg" alt="" /><br>
            <span class="fileLabel"></span>
          </div>
        </td>
        <td class="vis2">
          <div style="position:relative">
            <input type="file" name="images" onchange="readURL(this);" id="fileInput" hidden='hidden' class="blah2" />
            <div style="position:absolute">
              <i id="cross2" class="fas0 fa-times"></i>
            </div>
            <i id="plus2" class="far fa-plus-square fileButton"></i><br>
            <img id="blah2" class="Img" src="images/Imagehere.jpg" alt="" /><br>
            <span class="fileLabel"></span>
          </div>
        </td>
      </tr>
      <tr>
        <td class="vis3">
          <div style="position:relative">
            <input type="file" name="images" onchange="readURL(this);" id="fileInput" hidden='hidden' class="blah3" />
            <div style="position:absolute">
              <i id="cross3" class="fas0 fa-times" onclick='crossfun(this)'></i>
            </div>
            <i id="plus3" class="far fa-plus-square fileButton"></i><br>
            <img id="blah3" class="Img" src="images/Imagehere.jpg" alt="" /><br>
            <span class="fileLabel"></span>
          </div>
        </td>
        <td class="vis4">
          <div style="position:relative">
            <input type="file" name="images" onchange="readURL(this);" id="fileInput" hidden='hidden' class="blah4" />
            <div style="position:absolute">
              <i id="cross4" class="fas0 fa-times" onclick='crossfun(this)'></i>
            </div>
            <i id="plus4" class="far fa-plus-square fileButton"></i><br>
            <img id="blah4" class="Img" src="images/Imagehere.jpg" alt="" /><br>
            <span class="fileLabel"></span>
          </div>
        </td>
        <td class="vis5">
          <div style="position:relative">
            <input type="file" name="images" onchange="readURL(this);" id="fileInput" hidden='hidden' class="blah5" />
            <div style="position:absolute">
              <i id="cross5" class="fas0 fa-times" onclick='crossfun(this)'></i>
            </div>
            <i id="plus5" class="far fa-plus-square fileButton"></i><br>
            <img id="blah5" class="Img" src="images/Imagehere.jpg" alt="" /><br>
            <span class="fileLabel"></span>
          </div>
        </td>
      </tr>
      <tr>
        <td class="vis6">
          <div style="position:relative">
            <input type="file" name="images" onchange="readURL(this);" id="fileInput" hidden='hidden' class="blah6" />
            <div style="position:absolute">
              <i id="cross6" class="fas0 fa-times" onclick='crossfun(this)'></i>
            </div>
            <i id="plus6" class="far fa-plus-square fileButton"></i><br>
            <img id="blah6" class="Img" src="images/Imagehere.jpg" alt="" /><br>
            <span class="fileLabel"></span>
          </div>
        </td>
        <td class="vis7">
          <div style="position:relative">
            <input type="file" name="images" onchange="readURL(this);" id="fileInput" hidden='hidden' class="blah7" />
            <div style="position:absolute">
              <i id="cross7" class="fas0 fa-times" onclick='crossfun(this)'></i>
            </div>
            <i id="plus7" class="far fa-plus-square fileButton"></i><br>
            <img id="blah7" class="Img" src="images/Imagehere.jpg" alt="" /><br>
            <span class="fileLabel"></span>
          </div>
        </td>
        <td class="vis8">
          <div style="position:relative">
            <input type="file" name="images" onchange="readURL(this);" id="fileInput" hidden='hidden' class="blah8" />
            <div style="position:absolute">
              <i id="cross8" class="fas0 fa-times" onclick='crossfun(this)'></i>
            </div>
            <i id="plus8" class="far fa-plus-square fileButton"></i><br>
            <img id="blah8" class="Img" src="images/Imagehere.jpg" alt="" /><br>
            <span class="fileLabel"></span>
          </div>
        </td>
      </tr>
    </table>
  </div>
  <br>

  <!-- uploading images here  -->
  <div class="w3-row-padding">
    <div class="w3-half">
      <label for="contact">Contact No</label>
      <input class="w3-input w3-border" type="text" name="contact" />
    </div>
  </div>
  <br />
  <br>
  <div class="w3-row-padding">
    <div class="w3-half">
      <label for="address">Address</label>
      <textarea class="w3-input w3-border" name="address"></textarea>
    </div>
  </div>
  <div class="w3-row-padding" style="padding:2% 0px ">
    <div class="w3-half">
      <button type="submit">Submit</button>
    </div>
  </div>

</form>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
  Array.prototype.forEach.call(document.querySelectorAll('.fileButton'), function(button) {
    const hiddenInput = button.parentElement.querySelector('#fileInput')
    let label = button.parentElement.querySelector('.fileLabel')
    const defaultText = "No file selected";
    label.textContent = defaultText;
    button.addEventListener('click', function(e) {
      e.preventDefault();
      hiddenInput.click();
    })
    hiddenInput.addEventListener('change', function() {
      const newText = "1 file selected"
      label.textContent = '1 file selected'
    })
  })

  var noPic = true;

  function readURL(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();
      var nextPic;
      var currentPic;
      currentPic = parseInt(input.className[4]);
      nextPic = parseInt(input.className[4]) + 1;
      reader.onload = function(e) {
        if (noPic) {
          $('#cover-pic')
            .attr('src', e.target.result)
            .width(300)
            .height(300)
            .css('border', '5px solid grey');
          noPic = false;
        }
        $('#' + input.className)
          .attr('src', e.target.result);
      };
      reader.readAsDataURL(input.files[0]);
      $('.vis' + nextPic).removeClass('vis' + nextPic);
      $('#plus' + currentPic).css('display', 'none');
      $('#cross' + currentPic).css('display', 'inline-block');
    }
  }

  $('.Img').click(function() {
    var coverPic = $(this).attr('src');
    console.log(coverPic);
    if (coverPic != 'images/Imagehere.jpg') {
      $('#cover-pic')
        .attr('src', coverPic)
        .width(300)
        .height(300)
        .css('border', '5px solid grey');
    }
  })

  $('.fa-times').click(function() {
    var currentCross = $(this).attr('id')[5];
    var imageValue = $('#blah' + currentCross).attr('src');
    var coverPicValue = $('#cover-pic').attr('src');
    if (imageValue == coverPicValue) {
      $('#cover-pic').attr('src', '');
    }
    $('#cross' + currentCross).css('display', 'none');
    $('#plus' + currentCross).css('display', 'inline-block');
    $('#blah' + currentCross).attr('src', 'images/Imagehere.jpg');
  })

  var URL = "http://localhost:3001/category";

  $.ajax({
    url: URL,
    method: "GET"
  }).done(function(catagories) {
    catagories.forEach(category => {
      $('#category').append("<option value='" + category.name + "'>" + category.name + "</option>")
    });
  }).fail(function() {
    console.log('FAIL!!')
  })


  // function crossfun(input) {
  //   if (input.files && input.files[0]) {
  //     var reader = new FileReader();
  //     var nextPic;
  //     var currentPic;
  //     currentPic = parseInt(input.className[4]);
  //     nextPic = parseInt(input.className[4]) + 1;
  //     reader.onload = function(e) {
  //       $('#' + input.className)
  //         .attr('src', "images/Imagehere.jpg");
  //     };
  //     reader.readAsDataURL(input.files[0]);
  //   }
  // }
</script>

<%-include('partials/footer')-%>
